<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="15.0">

  <PropertyGroup Label="SwaggerProps">
    <SwaggerBuildDir>AutoGeneratedFilesBySwagger</SwaggerBuildDir>
  </PropertyGroup>

  <Target Name="GenerateSwaggerSpec" AfterTargets="Build"
          Condition= "$(ExeGenSwag) == 'True' and $(PublishDir) != ''">
    <Message Text="### Executing Swashbuckle Swagger Spec. Generation over $(OutputPath)$(AssemblyName).dll ###" Importance="High" />
    <MakeDir Directories="$(SwaggerBuildDir)\" Condition="!Exists('$(OutputPath)\\$(SwaggerBuildDir)')" />
    <Exec Command="dotnet swagger tofile --output $(SwaggerBuildDir)\\$(AssemblyName).swagger.json $(OutputPath)$(AssemblyName).dll v1.0" />
    <Error Condition="Exists($(AssemblyName))" Text="The assembly file could not be found, please publish the version before generating client" />
  </Target>

</Project>